<div class="text-center mt-3">
    <h2>Register for Internet Banking</h2>
</div>

<!-- form -->
<div class="container align-center py-3 border w-75">
    <form #ibRegisterForm="ngForm">
        <div class="text-left">
            <!-- accountNumber -->
        <div class="row mt-5 form-group">
            <div class="col-md-6">
                <label for=""><h5>Account Number<span class="text-danger">*</span></h5></label>
            </div>
            <div class="col-md-6 form-group">
                <input name="accountNumber" #accountNumber="ngModel" [(ngModel)]="ibRegister.accountNumber" type="number" 
                placeholder="Account Number" class="form-control" required min=10000000000 max=99999999999>
                <div *ngIf="!accountNumber?.valid && (accountNumber?.dirty || accountNumber?.touched)" class="error">
                    <div *ngIf="accountNumber.errors?.required">
                        <small class="text-danger">Account Number required</small>
                    </div>
                    <div *ngIf="accountNumber.errors?.min || accountNumber.errors?.max">
                        <small class="text-danger">Account Number must be 11 digit number</small>
                    </div>
                </div>
            </div>
        </div>
        <!-- loginPassword -->
        <div class="row mt-3 form-group">
            <div class="col-md-6">
                <label for=""><h5>Set Login Password<span class="text-danger">*</span></h5></label>
            </div>
            <div class="col-md-6 form-group">
                <input type="password" name="loginPassword" #loginPassword="ngModel" [(ngModel)]="ibRegister.loginPassword" placeholder="Login Password" 
                class="form-control" required pattern="(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[$@$!%*?&])[A-Za-z\d$@$!%*?&].{8,}">
                <div *ngIf="!loginPassword?.valid && (loginPassword?.dirty || loginPassword?.touched)" class="error">
                    <div *ngIf="loginPassword.errors?.required">
                        <small class="text-danger">Login Password required</small>
                    </div>
                    <div *ngIf="loginPassword.errors?.pattern">
                        <small class="text-danger">Minimum 8 characters and atleast one lowercase, uppercase, special, number</small>
                    </div>
                </div>
            </div>
        </div>
        <!-- confirmLoginPassword -->
        <div class="row mt-3 form-group">
            <div class="col-md-6">
                <label for=""><h5>Confirm Login Password<span class="text-danger">*</span></h5></label>
            </div>
            <div class="col-md-6 form-group">
                <input  name="confirmLoginPassword" #confirmLoginPassword="ngModel" [(ngModel)]="ibRegister.confirmLoginPassword" type="text"
                 placeholder="Confirm Login Password" class="form-control" required pattern="(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[$@$!%*?&])[A-Za-z\d$@$!%*?&].{8,}">
                 <div *ngIf="!confirmLoginPassword?.valid && (confirmLoginPassword?.dirty || confirmLoginPassword?.touched)" class="error">
                    <div *ngIf="confirmLoginPassword.errors?.required">
                        <small class="text-danger">Login Password required</small>
                    </div>
                    <!-- Check if both passowrd are same -->
                    <!-- <div *ngIf="confirmLoginPassword.errors?.minlength">
                        <small class="text-danger">OTP must be 4 digit number</small>
                    </div> -->
                </div>
            </div>
        </div>
        <!-- transactionPassword -->
        <div class="row mt-3 form-group">
            <div class="col-md-6">
                <label for=""><h5>Set Transaction Password<span class="text-danger">*</span></h5></label>
            </div>
            <div class="col-md-6 form-group">
                <input type="password" name="transactionPassword" #transactionPassword="ngModel" [(ngModel)]="ibRegister.transactionPassword" 
                placeholder="Transaction Password" class="form-control" required pattern="(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[$@$!%*?&])[A-Za-z\d$@$!%*?&].{8,}">
                <div *ngIf="!transactionPassword?.valid && (transactionPassword?.dirty || transactionPassword?.touched)" class="error">
                    <div *ngIf="transactionPassword.errors?.required">
                        <small class="text-danger">Transaction Password required</small>
                    </div>
                    <div *ngIf="transactionPassword.errors?.pattern">
                        <small class="text-danger">Minimum 8 characters and atleast one lowercase, uppercase, special, number</small>
                    </div>
                </div>
            </div>
        </div>
        <!-- confirmTransactionPassword -->
        <div class="row mt-3 form-group">
            <div class="col-md-6">
                <label for=""><h5>Confirm Transaction Password<span class="text-danger">*</span></h5></label>
            </div>
            <div class="col-md-6 form-group">
                <input name="confirmTransactionPassword" #confirmTransactionPassword="ngModel" [(ngModel)]="ibRegister.confirmTransactionPassword" 
                type="text" placeholder="Confirm Transaction Password" class="form-control" required pattern="(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[$@$!%*?&])[A-Za-z\d$@$!%*?&].{8,}">
                <div *ngIf="!confirmTransactionPassword?.valid && (confirmTransactionPassword?.dirty || confirmTransactionPassword?.touched)" class="error">
                    <div *ngIf="confirmTransactionPassword.errors?.required">
                        <small class="text-danger">Transaction Password required</small>
                    </div>
                    <!-- check if both password are same -->
                    <!-- <div *ngIf="confirmTransactionPassword.errors?.minlength">
                        <small class="text-danger">OTP must be 4 digit number</small>
                    </div> -->
                </div>
            </div>
        </div>
        <!-- OTP -->
        <div class="row mt-3 form-group">
            <div class="col-md-6">
                <label for=""><h5>OTP<span class="text-danger">*</span></h5></label>
            </div>
            <div class="col-md-6 form-group">
                <input name="otp" #otp="ngModel" [(ngModel)]="ibRegister.otp" type="number" placeholder="OTP" class="form-control" required min=100000 max=999999>
                <div *ngIf="!otp?.valid && (otp?.dirty || otp?.touched)" class="error">
                    <div *ngIf="otp.errors?.required">
                        <small class="text-danger">OTP required</small>
                    </div>
                    <div *ngIf="otp.errors?.min || otp.errors?.max">
                        <small class="text-danger">OTP must be 6 digit number</small>
                    </div>
                </div>
                <button (click)="getOtp(ibRegisterForm.value.accountNumber)" 
                class="float-end btn btn-primary mt-3 btn-sm" [disabled]="confirmTransactionPassword.invalid">Get OTP</button>
            </div>
        </div>
    </div>
        <!-- Submit button -->
        <div class="row">
            <div class="col">
                <a routerLink="/home" class="btn btn-danger float-end">Back</a>
            </div>
            <div class="col">
                <div class="">
                    <button (click)="registerInternetBanking(ibRegisterForm.value.otp, ibRegisterForm.value.loginPassword, ibRegisterForm.value.confirmLoginPassword, ibRegisterForm.value.transactionPassword, ibRegisterForm.value.confirmTransactionPassword, ibRegisterForm.value.accountNumber)" 
                    [disabled]="ibRegisterForm.invalid" class="btn btn-success">Submit</button>
                </div>
            </div>
        </div>
    </form>
</div>
